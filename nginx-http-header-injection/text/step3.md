## 防御策

根本的対策としては、外部からのパラメータをHTTPレスポンスヘッダとして出力しない実装をする必要があります。具体的には、リダイレクト先をURLでなく番号等で指定したり、開発ツールのセッション変数を使ってURLを受け渡すなどの対策を行います。

どうしても外部からのパラメータをHTTPレスポンスヘッダとして出力しなければならない場合は、以下の2点を実行します。

* a) リダイレクトやクッキー出力を専用APIにまかせる: 各言語が持つHTTPレスポンスヘッダ出力機能（PHPの場合は`setcookie`や`header`など）を使います。
* b) ヘッダ生成するパラメータの改行文字をチェックする: a)で対策が不十分な場合に対処するため、以下の2点を実行します。
    - b.1) URL中の改行をエラーとする
    - b.2) クッキー値の中にある改行はパーセンドエンコードする
