## 攻撃方法

コマンドを呼び出すためのシェル文を組み立てる際、外部からのパラメータの処理が不適切だと、パラメータとして与えたシェルコマンドを実行することが可能になります。

一例として、メールの送信を行うための

```php
// $mail は外部から与えられるメールアドレス
system("/usr/sbin/sendmail -i <send.txt $mail");
```

というPHPコードを考えてみます。

このPHPコードで、外部からのメールアドレス`$mail`に、`test@example.jp; cat /etc/passwd`という形で正規のメールアドレス以外のシェル文として解釈され得るコマンドを追記すると

```php
system("/usr/sbin/sendmail -i <send.txt test@example.jp; cat /etc/passwd");
```

というコードが実行されるため、このコードを使って`/etc/passwd`の内容を表示させることが可能になってしまいます。

このような攻撃が可能となる条件としては、

* CGIプログラムなどでシェル機能を呼び出す関数を使用している(PHPの`system`など)
* シェル機能を呼び出す関数にパラメータを渡している
* パラメータ中に含まれるシェルのメタ文字がエスケープされていない

の3つをすべて満たす必要があります。
