## 防御策

### サーバーサイドでのHTTPリクエスト送信機能

サーバーサイドでのHTTPリクエスト送信機能については以下の対策を行います。

入力値が内部IPアドレス及び、利用しているクラウドサービスのメタデータ提供URLである場合はHTTPリクエストを送信しないようにします。  
入力されたドメイン名やURLスキームをサーバーサイドで事前に検証し、内容に問題があるものをチェックして排除するという方針を強く推奨します。  
ただし、IPアドレスの表記に際しては0x7f.1のような Rare IP Address Format （極めて稀なIPアドレス形式）も現実には利用可能であるため、正規表現を一から書くなどの間違いの入り込みやすい方法を使うのではなく、すべての場合を網羅しているアドレス解釈のためのライブラリを使う必要があります。

### XMLのXXE対策

XXEに対しては以下の対策を行います。

XMLの代わりにJSONを使える場合はJSONを使います。  
PHPならばlibxml2のバージョン2.9以降を使います。（デフォルトで外部実体参照を行わない設定となっています。）  
PHPならばlibxml_disable_entity_loader(true)を呼び出して外部実体参照を禁止します。  
Javaのように外部実体参照が有効な場合は、DTDを禁止します。  
